<!DOCTYPE html>
<html>
<head>
    <script>
        //modified from http://jsfiddle.net/bencentra/q1s8gmqv/?utm_source=website&utm_medium=embed&utm_campaign=q1s8gmqv
        var canvas;
        var context;
        var loop;
        var leftPaddle;
        var rightPaddle;
        var topPaddle;
        var bottomPaddle;
        var ball;
        var paddleWidth = 25;
        var paddleHeight = 100;
        var S = 83;
        var UP = 38;
        var DOWN = 40;
        var G = 45;
        var H = 55;
        var Z = 67;
        var M = 87;

        // Keep track of pressed keys
        var keys = {
            W: false,
            S: false,
            UP: false,
            DOWN: false
            DOWN: false,
            G: false,
            H: false,
            Z: false,
            M: false
        };

        // Keep track of the score
        var leftScore = 0;
        var rightScore = 0;
        var topScore = 0;
        var bottomScore = 0;
        function init() {
            canvas = document.getElementById("board");
            if (canvas.getContext) {
                context = canvas.getContext("2d");
                leftPaddle = makeRect(25, canvas.height / 2 - paddleHeight / 2, paddleWidth, paddleHeight, 5, '#BC0000');
                topPaddle = makeRect(25, canvas.width / 2 - paddleHeight / 2, paddleWidth, paddleHeight, 5, '#BB0000');
                rightPaddle = makeRect(canvas.width - paddleWidth - 25, canvas.height / 2 - paddleHeight / 2, paddleWidth, paddleHeight, 5, '#0000BC');
                bottomPaddle = makeRect(canvas.height - paddleWidth - 25, canvas.height / 2 - paddleHeight / 2, paddleWidth, paddleHeight, 5, '#0000CB');
                ball = makeRect(0, 0, ballSize, ballSize, ballSpeed, '#000000');
                drawables.push(leftPaddle);
                drawables.push(rightPaddle);
                drawables.push(topPaddle);
                drawables.push(bottomPaddle);
                drawables.push(ball);
                console.log(drawables);
                resetBall();
            if (keys.DOWN) {
                leftPaddle.y += leftPaddle.s;
            }
            if (keys.G) {
                leftPaddle.x -= leftPaddle.s;
            }
            if (keys.H) {
                leftPaddle.x += leftPaddle.s;
            }
            if (keys.Z) {
                leftPaddle.x -= leftPaddle.s;
            }
            if (keys.M) {
                leftPaddle.x += leftPaddle.s;
            }
            clampToCanvas(leftPaddle);
        }
        function clampToCanvas(paddle) {
                paddle.y = canvas.height - paddle.h;
            }
        }
        function clampToCanvas1(paddle) {
            if (paddle.x < 0) {
                paddle.x = 0;
            }
            if (paddle.x + paddle.w > canvas.width) {
                paddle.x = canvas.width - paddle.w;
            }
        }
        clampToCanvas1(topPaddle);
        clampToCanvas1(bottomPaddle);
        function moveBall() {
            // Move the ball
            ball.x += ball.sX;
            ball.y += ball.sY;
            // Bounce the ball off the top/bottom
            if (ball.y < 0 || ball.y + ball.h > canvas.height) {
                ball.sY *= -1;
            }
        }
        function checkPaddleCollision() {
            // Bounce the ball off the paddles
            if (ball.y + ball.h / 2 >= leftPaddle.y && ball.y + ball.h / 2 <= leftPaddle.y + leftPaddle.h) {
                if (ball.x <= leftPaddle.x + leftPaddle.w) {
                    bounceBall();
                }
            }
            if (ball.y + ball.h / 2 >= rightPaddle.y && ball.y + ball.h / 2 <= rightPaddle.y + rightPaddle.h) {
                if (ball.x + ball.w >= rightPaddle.x) {
                    bounceBall();
                }
            }
        }
        function checkScore() {
            // Score if the ball goes past a paddle
            if (ball.x < leftPaddle.x) {
                rightScore++;
                resetBall();
                ball.sX *= -1;
            } else if (ball.x + ball.w > rightPaddle.x + rightPaddle.w) {
                leftScore++;
                resetBall();
                ball.sX *= -1;
            }
        }
        function drawScores() {
            // Draw the scores
            context.fillStyle = '#000000';
            context.font = '24px Arial';
            context.textAlign = 'left';
            context.fillText('Score: ' + leftScore, 5, 24);
            context.textAlign = 'right';
            context.fillText('Score: ' + rightScore, canvas.width - 5, 24);
        }
        function erase() {
            context.fillStyle = '#FFFFFF';
            context.fillRect(0, 0, canvas.width, canvas.height);
        }
        function gameLoop() {
            erase();
            movePaddle();
            doAI();
            moveBall();
            checkPaddleCollision();
            checkScore();
            drawScores();
            //draw stuff
            for (let i = 0; i < drawables.length; i++) {
                drawables[i].draw();
            }
        }
    </script>
</head>
<body onload="init();">
<a href="http://bencentra.com/2017-07-11-basic-html5-canvas-games.html">Collection of Canvas based games by Ben Centra</a>
<main>
    <canvas id="board" width="600px" height="600px" style="border: 1px solid black;">
    </canvas>
</main>
</body>
</html>
